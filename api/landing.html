<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EnorEtt Pro - Upgrade Your Swedish Grammar</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 40px;
            max-width: 500px;
            width: 100%;
            text-align: center;
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.1),
                0 8px 16px rgba(0, 0, 0, 0.05);
        }
        
        .logo {
            font-size: 48px;
            font-weight: 700;
            margin-bottom: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        h1 {
            font-size: 32px;
            margin-bottom: 16px;
            color: #1F2937;
        }
        
        .subtitle {
            font-size: 18px;
            color: #6B7280;
            margin-bottom: 32px;
        }
        
        .features {
            text-align: left;
            margin: 32px 0;
        }
        
        .feature {
            display: flex;
            align-items: center;
            margin: 16px 0;
            font-size: 16px;
            color: #374151;
        }
        
        .feature-icon {
            margin-right: 12px;
            font-size: 20px;
        }
        
        .pricing {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 24px;
            border-radius: 16px;
            margin: 32px 0;
        }
        
        .price {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 8px;
        }
        
        .price-period {
            font-size: 16px;
            opacity: 0.9;
        }
        
        .upgrade-btn {
            background: white;
            color: #667eea;
            border: none;
            padding: 16px 32px;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 16px 0;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }
        
        .upgrade-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
        }
        
        .guarantee {
            font-size: 14px;
            color: #6B7280;
            margin-top: 16px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">en/ett</div>
        <h1>Upgrade to EnorEtt Pro</h1>
        <p class="subtitle">Master Swedish grammar with advanced features</p>
        
        <div class="features">
            <div class="feature">
                <span class="feature-icon">ðŸ“š</span>
                <span>10,000+ Swedish words (vs 1,000 free)</span>
            </div>
            <div class="feature">
                <span class="feature-icon">ðŸ¤–</span>
                <span>AI-powered phrase checking</span>
            </div>
            <div class="feature">
                <span class="feature-icon">âš¡</span>
                <span>Instant API access</span>
            </div>
            <div class="feature">
                <span class="feature-icon">ðŸŽ¯</span>
                <span>Advanced pattern recognition</span>
            </div>
            <div class="feature">
                <span class="feature-icon">ðŸ“±</span>
                <span>Priority support</span>
            </div>
        </div>
        
        <div class="pricing">
            <div class="price">30 kr</div>
            <div class="price-period">engÃ¥ngsavgift</div>
            <button class="upgrade-btn" onclick="handleUpgrade()">Upgrade Now</button>
            <div class="guarantee">30-day money-back guarantee</div>
        </div>
        
        <p style="font-size: 14px; color: #6B7280; margin-top: 24px;">
            Join 1,000+ Swedish learners who trust EnorEtt Pro
        </p>
    </div>
    
    <script>
        async function handleUpgrade() {
            try {
                // Get extension ID from URL or use default
                const urlParams = new URLSearchParams(window.location.search);
                const extensionId = urlParams.get('extensionId') || 'enorett';
                
                // Create checkout session via API
                // Use relative URL to work with any domain
                const apiUrl = window.location.origin;
                const response = await fetch(`${apiUrl}/api/subscription/create`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        extensionId: extensionId,
                        returnUrl: window.location.href + '?success=true',
                        cancelUrl: window.location.href + '?canceled=true'
                    })
                });
                
                if (!response.ok) {
                    throw new Error('Failed to create checkout session');
                }
                
                const data = await response.json();
                
                if (data.success && data.checkoutUrl) {
                    // Redirect to Stripe checkout
                    window.location.href = data.checkoutUrl;
                } else {
                    throw new Error('Invalid response from server');
                }
            } catch (error) {
                console.error('Upgrade error:', error);
                // Fallback: show contact info
                alert('Payment integration is being set up. For now, contact us at hello@enorett.se');
            }
        }
        
        // Handle payment success callback
        window.addEventListener('load', () => {
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('success') === 'true') {
                // Notify extension of successful payment
                if (chrome && chrome.runtime) {
                    chrome.runtime.sendMessage({
                        type: 'PAYMENT_SUCCESS',
                        data: {
                            sessionId: urlParams.get('session_id')
                        }
                    });
                }
                
                // Show success message
                alert('Payment successful! Your Pro subscription is now active.');
            } else if (urlParams.get('canceled') === 'true') {
                alert('Payment was canceled. You can try again anytime.');
            }
        });
    </script>
</body>
</html>
